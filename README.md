This code add by zhengyanjun is to perform SGM algorithm.
